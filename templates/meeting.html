{% extends "base.html" %}

{% block title %}AI 회의록 서기 - Gemini Auto{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card shadow-sm border-0 p-4">
            <h2 class="text-center mb-3 fw-bold">🎙️ AI 회의록 자동 작성</h2>
            <p class="text-center text-muted mb-4">
                클로바노트, 줌(Zoom) 등의 대화 기록(.txt)을 올리면<br>
                깔끔한 회의록으로 정리해 드립니다.
            </p>

            <form method="POST" enctype="multipart/form-data" onsubmit="showLoading()">
                <div class="mb-4">
                    <label class="form-label fw-bold">대화 기록 파일 (.txt)</label>
                    <input class="form-control form-control-lg" type="file" name="file" accept=".txt" required>
                    <div class="form-text">
                        Tip: 카카오톡 대화 내보내기 파일이나 음성 인식 텍스트 파일을 사용하세요.
                    </div>
                </div>

                <div class="d-grid">
                    <button type="submit" id="btnSubmit" class="btn btn-primary btn-lg">회의록 작성 시작 📝</button>
                    <button type="button" id="btnLoading" class="btn btn-secondary btn-lg" style="display:none;" disabled>
                        <span class="spinner-border spinner-border-sm me-2"></span>내용 분석 중...
                    </button>
                </div>
            </form>
        </div>

        {% if result %}
        <div class="card mt-4 p-4 shadow-sm border-primary">
            <h4 class="text-primary fw-bold mb-3">✅ 회의록 초안</h4>
            
            <textarea id="resultText" class="form-control bg-light mb-3" rows="15" style="font-family: 'Noto Sans KR';">{{ result }}</textarea>
            
            <div class="d-flex gap-2">
                <button onclick="copyResult()" class="btn btn-dark flex-grow-1">📋 클립보드 복사</button>
                <a href="/meeting" class="btn btn-outline-secondary">🔄 다른 파일 올리기</a>
            </div>
        </div>
        {% endif %}
    </div>
</div>

<script>
    function showLoading() {
        document.getElementById('btnSubmit').style.display = 'none';
        document.getElementById('btnLoading').style.display = 'block';
    }

    function copyResult() {
        const copyText = document.getElementById("resultText");
        copyText.select();
        navigator.clipboard.writeText(copyText.value).then(() => {
            alert("회의록이 복사되었습니다! 노션이나 메일에 붙여넣으세요.");
        });
    }
</script>
{% endblock %}